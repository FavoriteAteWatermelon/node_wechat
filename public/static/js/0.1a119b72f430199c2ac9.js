webpackJsonp([0],{Cdx3:function(t,e,o){var i=o("sB3e"),a=o("lktj");o("uqUo")("keys",function(){return function(t){return a(i(t))}})},"I1B+":function(t,e){},JXpH:function(t,e){t.exports={_args:[["vue-img-cutter@2.1.7","F:\\Vue\\project\\web\\eps2"]],_from:"vue-img-cutter@2.1.7",_id:"vue-img-cutter@2.1.7",_inBundle:!1,_integrity:"sha1-zYS3cqFE5qomGYQifu2qVqMrMjQ=",_location:"/vue-img-cutter",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"vue-img-cutter@2.1.7",name:"vue-img-cutter",escapedName:"vue-img-cutter",rawSpec:"2.1.7",saveSpec:null,fetchSpec:"2.1.7"},_requiredBy:["/"],_resolved:"https://registry.npm.taobao.org/vue-img-cutter/download/vue-img-cutter-2.1.7.tgz",_spec:"2.1.7",_where:"F:\\Vue\\project\\web\\eps2",author:{name:"acccccccb",email:"tabzhang@foxmail.com"},browserslist:["> 1%","last 2 versions","not ie <= 8"],bugs:{url:"https://github.com/acccccccb/vue-img-cutter/issues"},dependencies:{vue:"^2.5.2"},description:"A image crop plug-in for Vue,you can use it to rotate、zoom images and cut any size",devDependencies:{autoprefixer:"^7.1.2","babel-core":"^6.22.1","babel-helper-vue-jsx-merge-props":"^2.0.3","babel-loader":"^7.1.1","babel-plugin-syntax-jsx":"^6.18.0","babel-plugin-transform-runtime":"^6.22.0","babel-plugin-transform-vue-jsx":"^3.5.0","babel-preset-env":"^1.3.2","babel-preset-stage-2":"^6.22.0",chalk:"^2.0.1","copy-webpack-plugin":"^4.0.1","css-loader":"^0.28.0","extract-text-webpack-plugin":"^3.0.0","file-loader":"^1.1.4","friendly-errors-webpack-plugin":"^1.6.1","html-webpack-plugin":"^2.30.1","js-yaml":"^3.13.1",lodash:"^4.17.15",mem:"^6.0.0","mixin-deep":"^2.0.1","node-notifier":"^5.1.2","optimize-css-assets-webpack-plugin":"^3.2.0",ora:"^1.2.0",portfinder:"^1.0.13","postcss-import":"^11.0.0","postcss-loader":"^2.0.8","postcss-url":"^7.2.1",rimraf:"^2.6.0",semver:"^5.3.0","set-value":"^3.0.1",shelljs:"^0.7.6","uglifyjs-webpack-plugin":"^1.1.1","url-loader":"^0.5.8","vue-loader":"^13.3.0","vue-style-loader":"^3.0.1","vue-template-compiler":"^2.5.2",webpack:"^3.6.0","webpack-bundle-analyzer":"^2.13.1","webpack-dev-server":"^2.11.5","webpack-merge":"^4.1.0"},engines:{node:">= 6.0.0",npm:">= 3.0.0"},homepage:"https://ihtmlcss.com/demo/dist/#/croptool",keywords:["image","crop","cutter","vue","裁剪"],license:"Apache2.0",main:"./src/index.js",name:"vue-img-cutter",private:!1,repository:{type:"git",url:"git+https://github.com/acccccccb/vue-img-cutter.git"},scripts:{build:"node build/build.js",dev:"webpack-dev-server --inline --progress --config build/webpack.dev.conf.js",start:"npm run dev"},version:"2.1.7"}},MjS7:function(t,e){},TmV0:function(t,e,o){o("fZOM"),t.exports=o("FeBl").Object.values},fZOM:function(t,e,o){var i=o("kM2E"),a=o("mbce")(!1);i(i.S,"Object",{values:function(t){return a(t)}})},fZjL:function(t,e,o){t.exports={default:o("jFbC"),__esModule:!0}},gRE1:function(t,e,o){t.exports={default:o("TmV0"),__esModule:!0}},iLP3:function(t,e){},jFbC:function(t,e,o){o("Cdx3"),t.exports=o("FeBl").Object.keys},mbce:function(t,e,o){var i=o("+E39"),a=o("lktj"),n=o("TcQ7"),s=o("NpIQ").f;t.exports=function(t){return function(e){for(var o,l=n(e),r=a(l),c=r.length,h=0,d=[];c>h;)o=r[h++],i&&!s.call(l,o)||d.push(t?[o,l[o]]:l[o]);return d}}},mvHQ:function(t,e,o){t.exports={default:o("qkKv"),__esModule:!0}},o4pE:function(t,e){},qkKv:function(t,e,o){var i=o("FeBl"),a=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},uqUo:function(t,e,o){var i=o("kM2E"),a=o("FeBl"),n=o("S82l");t.exports=function(t,e){var o=(a.Object||{})[t]||Object[t],s={};s[t]=e(o),i(i.S+i.F*n(function(){o(1)}),"Object",s)}},xmxF:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("Dd8w"),a=o.n(i),n=o("mvHQ"),s=o.n(n),l=o("woOf"),r=o.n(l),c=o("bOdI"),h=o.n(c),d={props:{total:{type:Number,default:0}},methods:{_handleCurrentChange:function(t){this.$emit("handleCurrentChange",t)},_handleSizeChange:function(t){this.$emit("handleSizeChange",t)}}},u={render:function(){var t=this.$createElement;return(this._self._c||t)("el-pagination",{staticStyle:{"text-align":"right","margin-top":"10px"},attrs:{"page-sizes":[10,20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":this._handleSizeChange,"current-change":this._handleCurrentChange}})},staticRenderFns:[]};var g=o("VU/8")(d,u,!1,function(t){o("MjS7")},"data-v-507fe0ea",null).exports,m={props:{tableType:{type:String,defatult:""},pictLoading:{type:Boolean,default:!1},tableData:{type:Array,default:function(){return[]}},tableBarList:{type:Array,default:function(){return[]}}},methods:{exportExcel:function(t,e,i){var a=this;this.tableData.length?o.e(4).then(o.bind(null,"zWO4")).then(function(o){var n=a.tableData,s=a._formatJson(e,n);o.export_json_to_excel({header:t,data:s,filename:i})}):this.$message({message:"Please select at least one item",type:"warning"})},_formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})}}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:this.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-text":"数据正在加载中","element-loading-spinner":"el-icon-loading",stripe:!0,border:!0,data:this.tableData,"highlight-current-row":""}},this._l(this.tableBarList,function(t,o){return e("el-table-column",{key:o,attrs:{type:t.type,property:t.property,label:t.label,width:t.width}})}),1)},staticRenderFns:[]};var v=o("VU/8")(m,p,!1,function(t){o("I1B+")},"data-v-cb3c2daa",null).exports,f=o("pFYg"),x=o.n(f),w=o("JXpH"),b=o.n(w),y={name:"ImgCutter",props:{crossOrigin:{type:Boolean,default:!1,required:!1},crossOriginHeader:{type:String,default:"*",required:!1},label:{type:String,default:"选择图片",required:!1},isModal:{type:Boolean,default:!0,required:!1},lockScroll:{type:Boolean,default:!0,required:!1},showChooseBtn:{type:Boolean,default:!0,required:!1},boxWidth:{type:Number,default:800,required:!1},boxHeight:{type:Number,default:400,required:!1},cutWidth:{type:Number,default:200,required:!1},cutHeight:{type:Number,default:200,required:!1},rate:{type:String,default:null,required:!1},tool:{type:Boolean,default:!0,required:!1},toolBgc:{type:String,default:"#fff",required:!1},sizeChange:{type:Boolean,default:!0,required:!1},originalGraph:{type:Boolean,default:!1,required:!1},moveAble:{type:Boolean,default:!0,required:!1},CuttingOriginal:{type:Boolean,default:!1,required:!1},WatermarkText:{type:String,default:"",required:!1},WatermarkTextFont:{type:String,default:"12px Sans-serif",required:!1},WatermarkTextColor:{type:String,default:"#fff",required:!1},WatermarkTextX:{type:Number,default:.95,required:!1},WatermarkTextY:{type:Number,default:.95,required:!1},DoNotDisplayCopyright:{type:Boolean,default:!1,required:!1}},model:["label","boxWidth","boxHeight","rate","tool","DoNotDisplayCopyright"],data:function(){return{version:"",visible:!1,fileName:"",cutImageObj:null,onPrintImgTimmer:null,toolBoxPosition:{x:0,y:0},drawImg:{img:null,sx:0,sy:0,swidth:0,sheight:0,x:0,y:0,width:0,height:0},toolBox:{disable:!0,width:this.boxWidth/2,height:this.boxHeight/2,x:0,y:0,boxMove:{start:{x:0,y:0},moveTo:{x:0,y:0}}},dropImg:{active:!1,pageX:0,pageY:0,params:{}},rotateImg:{angle:0},rotateControl:{active:!1,start:{x:0,y:0},position:100},scaleImg:{rate:0,params:{}},controlBox:{disable:!0,btnName:"",start:{x:0,y:0,width:0,height:0}},selectBox:!1,selectBoxColor:"rgba(0,0,0,0.6)",isFlipHorizontal:!1,isFlipVertically:!1}},mounted:function(){var t=this;this.version=b.a.version,!1===this.isModal&&(this.visible=!0,this.$nextTick(function(){t.$refs.toolBox.onmousewheel=t.scaleImgWheel,t.$refs.toolBox.addEventListener("DOMMouseScroll",t.scaleImgWheel)}))},methods:{handleOpen:function(t){var e=this,o=this,i=function(t){if(o.$refs.toolBox.onmousewheel=e.scaleImgWheel,o.$refs.toolBox.addEventListener("DOMMouseScroll",e.scaleImgWheel),!0===o.isModal){!0===o.lockScroll&&(document.body.style.overflowY="hidden");var i=o.$refs.dialogMainModalRef.offsetHeight+200,a=window.innerHeight,n=o.$refs.mask;n.style.overflowY=i>a?"scroll":"hidden"}t&&"function"==typeof t&&t()};if(t&&"object"==(void 0===t?"undefined":x()(t))&&t.src){if(!(t.width&&t.height&&t.name))throw new Error("传入参数必须包含：src,width,height,name");var a=new Image;!0===this.crossOrigin&&(a.crossOrigin=this.crossOriginHeader),a.name=t.name,a.width=t.width,a.height=t.height,a.style.position="fixed",a.style.top=-5e3,a.style.opacity=0,a.onerror=function(t){console.error("图片加载失败"),o.$emit("error",{event:t,msg:"图片加载失败"}),o.clearCutImageObj()},a.onload=function(){if(!0!==a.complete)throw new Error("图片加载失败");o.visible=!0,o.$nextTick(function(){i(function(){o.importImgToCanv(a)})})},a.src=t.src,this.cutImageObj=a,document.body.appendChild(a),this.$emit("onChooseImg",t)}else o.visible=!0,o.$nextTick(function(){i()})},handleClose:function(){var t=this;this.clearAll(),!0===this.isModal&&(!0===this.lockScroll&&(document.body.style.overflowY="scroll"),this.$nextTick(function(){t.visible=!1}))},chooseImg:function(){this.$refs.inputFile.click()},importImgToCanv:function(t){this.fileName=t.name;var e=t.height,o=t.width,i=this.boxWidth,n=this.boxHeight,s=void 0,l=a()({},this.drawImg);l.img=t,this.scaleImg.rate=o/e,e<n&&o<i?(s=1,l.x=(i-o)/2,l.y=(n-e)/2):o/e<=i/n?(s=n/e,l.x=(i-o*s)/2):(s=i/o,l.y=(n-e*s)/2),l.swidth=o,l.sheight=e,l.width=o*s,l.height=e*s,l.x=(i-l.width)/2,l.y=(n-l.height)/2,this.$set(this,"drawImg",l),this.printImg(),this.putToolBox()},putImgToCanv:function(t){var e=this,o=void 0;if(!t.target.files)return console.error("IE9及以下需要自己传入image对象"),!1;if(o=t.target.files[0]||null){this.fileName=o.name;var i=new FileReader;new Image,i.readAsDataURL(o),i.onload=function(t){var o=t.target.result,n=document.createElement("img");n.src=o;var s=setInterval(function(){if(2==i.readyState){clearInterval(s);var t=n.height,o=n.width,l=e.boxWidth,r=e.boxHeight,c=void 0,h=a()({},e.drawImg);h.img=n,e.scaleImg.rate=o/t,t<r&&o<l?(c=1,h.x=(l-o)/2,h.y=(r-t)/2):o/t<=l/r?(c=r/t,h.x=(l-o*c)/2):(c=l/o,h.y=(r-t*c)/2),h.swidth=o,h.sheight=t,h.width=o*c,h.height=t*c,h.x=(l-h.width)/2,h.y=(r-h.height)/2,e.$set(e,"drawImg",h),e.printImg()}},200)},this.putToolBox(),this.$emit("onChooseImg",o)}},putToolBox:function(){this.toolBox.width=this.cutWidth>this.boxWidth?this.boxWidth:this.cutWidth,this.toolBox.height=this.cutHeight>this.boxHeight?this.boxHeight:this.cutHeight,this.toolBox.x=this.boxWidth/2-this.toolBox.width/2,this.toolBox.y=this.boxHeight/2-this.toolBox.height/2,this.drawControlBox(this.toolBox.width,this.toolBox.height,this.toolBox.x,this.toolBox.y)},isSupportFileApi:function(){return!!(window.File&&window.FileList&&window.FileReader&&window.Blob&&-1===navigator.userAgent.indexOf("Edge")&&-1===navigator.userAgent.indexOf("MSIE")&&-1===navigator.userAgent.indexOf("Trident"))},dataURLtoFile:function(t,e){for(var o=t.split(","),i=o[0].match(/:(.*?);/)[1],a=atob(o[1]),n=a.length,s=new Uint8Array(n);n--;)s[n]=a.charCodeAt(n);return this.isSupportFileApi()?new File([s],e,{type:i}):"不支持File对象"},clearAll:function(){var t=this.$refs.canvas;t.getContext("2d").clearRect(0,0,t.width,t.height);var e=this.$refs.canvasSelectBox;e.getContext("2d").clearRect(0,0,e.width,e.height),this.drawImg={img:null,sx:0,sy:0,swidth:0,sheight:0,x:0,y:0,width:0,height:0},this.isFlipHorizontal=!1,this.isFlipVertically=!1,this.$refs.inputFile.value="",this.rotateImg.angle=0,this.drawImg.img=null,this.turnReset(),this.clearCutImageObj(),this.$emit("onClearAll")},clearCutImageObj:function(){null!==this.cutImageObj&&void 0!==this.cutImageObj&&("function"==typeof this.cutImageObj.remove?this.cutImageObj.remove():this.cutImageObj.removeNode()),this.cutImageObj=null},drawControlBox:function(t,e,o,i){var a=this;t>this.boxWidth&&(t=this.boxWidth),e>this.boxHeight&&(e=this.boxHeight),o<0&&(o=0),i<0&&(i=0);var n=this.$refs.toolBoxControl,s=this.$refs.canvasSelectBox,l=s.getContext("2d");l.fillStyle=this.selectBoxColor,l.clearRect(0,0,s.width,s.height),l.fillRect(0,0,s.width,s.height);var r=void 0,c=void 0;if(this.rate&&""!==this.rate){var h=this.rate.split(":")[0]/this.rate.split(":")[1];h>=1?(r=t,c=t/h):(r=e*h,c=e)}else r=t,c=e;this.toolBox.width=r,this.toolBox.height=c,n.style.width=Math.abs(r)+"px",n.style.height=Math.abs(c)+"px",this.toolBox.boxMove.moveTo.x=o,this.toolBox.boxMove.moveTo.y=i,r<0&&(o+=r),c<0&&(i+=c),o+this.toolBox.width>this.boxWidth&&(o=this.boxWidth-this.toolBox.width),o<0&&(o=0),i+this.toolBox.height>this.boxHeight&&(i=this.boxHeight-this.toolBox.height),i<0&&(i=0),this.toolBoxPosition.x=o,this.toolBoxPosition.y=i,n.style.left=o+"px",n.style.top=i+"px",l.clearRect(o,i,Math.abs(r),Math.abs(c)),this.onPrintImgTimmer&&clearTimeout(this.onPrintImgTimmer),this.onPrintImgTimmer=setTimeout(function(){a.cropPicture(!0)},100)},resetToolBox:function(){this.toolBox.width<0&&(this.toolBox.boxMove.moveTo.x=this.toolBox.x-this.toolBox.width),this.toolBox.height<0&&(this.toolBox.boxMove.moveTo.y=this.toolBox.y-this.toolBox.height),this.toolBox.width=Math.abs(this.toolBox.width),this.toolBox.height=Math.abs(this.toolBox.height)},toolBoxMouseDown:function(t){var e=this.$refs.toolBoxControl;this.toolBox.x=parseInt(e.style.left.split("px")[0]),this.toolBox.y=parseInt(e.style.top.split("px")[0]),this.toolBox.disable=!1,this.dropImg.active=!1,this.toolBox.boxMove.start={x:t.pageX,y:t.pageY}},toolBoxMouseMove:function(t){if(this.dropImg.active&&this.dropImgMove(t),!1===this.toolBox.disable&&!0===this.moveAble){var e=t.pageX-this.toolBox.boxMove.start.x,o=t.pageY-this.toolBox.boxMove.start.y,i=this.toolBox.x+e,a=this.toolBox.y+o;this.drawControlBox(this.toolBox.width,this.toolBox.height,i,a)}},toolBoxMouseLeave:function(){var t=this;this.toolBox.disable=!0,this.onPrintImgTimmer&&clearTimeout(this.onPrintImgTimmer),this.onPrintImgTimmer=setTimeout(function(){t.cropPicture(!0)},100),this.resetToolBox()},toolBoxMouseUp:function(t){this.toolBox.x=parseInt(this.toolBoxPosition.x),this.toolBox.y=parseInt(this.toolBoxPosition.y),this.toolBox.disable=!0,this.dropImg.active=!1,this.resetToolBox()},printImg:function(){var t=this;if(this.drawImg.img){var e=this.$refs.canvas,o=e.getContext("2d");o.font="18px bold 黑体",o.fillStyle="#ff0",o.textAlign="center",o.textBaseline="middle",o.save(),o.clearRect(0,0,e.width,e.height),o.translate(this.drawImg.x+this.drawImg.width/2,this.drawImg.y+this.drawImg.height/2),o.rotate(this.rotateImg.angle*Math.PI/180),o.translate(-(this.drawImg.x+this.drawImg.width/2),-(this.drawImg.y+this.drawImg.height/2)),o.translate(this.drawImg.x,this.drawImg.y),o.scale(this.isFlipHorizontal?-1:1,this.isFlipVertically?-1:1),o.drawImage(this.drawImg.img,this.drawImg.sx,this.drawImg.sy,this.drawImg.swidth,this.drawImg.sheight,this.isFlipHorizontal?-this.drawImg.width:0,this.isFlipVertically?-this.drawImg.height:0,this.drawImg.width,this.drawImg.height),o.translate(-this.drawImg.x,this.drawImg.y),o.restore(),this.onPrintImgTimmer&&clearTimeout(this.onPrintImgTimmer),this.onPrintImgTimmer=setTimeout(function(){t.cropPicture(!0)},100)}},dropImgOn:function(t){this.dropImg.active=!0,this.dropImg.params=a()({},this.drawImg),this.dropImg.pageX=t.pageX,this.dropImg.pageY=t.pageY},dropImgOff:function(){var t=this;this.dropImg.active=!1,this.onPrintImgTimmer&&clearTimeout(this.onPrintImgTimmer),this.onPrintImgTimmer=setTimeout(function(){t.cropPicture(!0)},100)},dropImgMove:function(t){if(this.dropImg.active&&this.drawImg.img){var e=a()({},this.drawImg);e.x=this.dropImg.params.x-(this.dropImg.pageX-t.pageX),e.y=this.dropImg.params.y-(this.dropImg.pageY-t.pageY),this.$set(this,"drawImg",e),this.printImg(),t.stopPropagation()}},scaleReset:function(){this.drawImg.width=this.drawImg.swidth,this.drawImg.height=this.drawImg.sheight,this.printImg()},scaleImgWheel:function(t){var e=this;if(this.drawImg.img){var o=void 0,i=t||window.event;i.wheelDelta?o=-i.wheelDelta/40:i.detail&&(o=i.detail);this.drawImg.x=this.drawImg.width-9*o>50?this.drawImg.x+3*o:this.drawImg.x,this.drawImg.y=this.drawImg.width-9*o>50?this.drawImg.y+3*o:this.drawImg.y,this.drawImg.width=this.drawImg.width-9*o>50?this.drawImg.width-9*o:50,this.drawImg.height=this.drawImg.width/this.scaleImg.rate,this.printImg(),this.onPrintImgTimmer&&clearTimeout(this.onPrintImgTimmer),this.onPrintImgTimmer=setTimeout(function(){e.cropPicture(!0)},100)}return t.preventDefault(),t.returnValue=!1,!1},flipHorizontal:function(){this.drawImg.img&&(0==this.isFlipHorizontal?this.isFlipHorizontal=!0:this.isFlipHorizontal=!1,this.printImg())},flipVertically:function(){this.drawImg.img&&(0==this.isFlipVertically?this.isFlipVertically=!0:this.isFlipVertically=!1,this.printImg())},turnImg:function(t){var e=this.rotateImg.angle+t;e>=-180&&e<=180&&(this.rotateImg.angle=e,this.rotateControl.position=e/180*100+100,this.printImg("rotate"))},turnReset:function(){this.rotateImg.angle=0,this.rotateControl.position=100,this.printImg("rotate")},controlBtnMouseDown:function(t,e){this.controlBox.disable=!1,this.controlBox.btnName=e,this.controlBox.start.x=t.clientX,this.controlBox.start.y=t.clientY,this.controlBox.start.width=this.toolBox.width,this.controlBox.start.height=this.toolBox.height,t.stopPropagation()},controlBtnMouseUp:function(t){this.controlBox.disable=!0,this.dropImgOff(),this.resetToolBox(),this.toolBoxMouseUp(),t.stopPropagation()},controlBtnMouseMove:function(t){if(!1===this.controlBox.disable){var e=t.clientX-this.controlBox.start.x,o=t.clientY-this.controlBox.start.y,i=void 0,a=void 0;"leftUp"==this.controlBox.btnName&&(i=this.toolBox.x+e,a=this.toolBox.y+o,this.toolBox.width=this.controlBox.start.width-e,this.toolBox.height=this.controlBox.start.height-o),"rightUp"==this.controlBox.btnName&&(i=this.toolBox.x,a=this.toolBox.y+o,this.toolBox.width=this.controlBox.start.width+e,this.toolBox.height=this.controlBox.start.height-o),"rightDown"==this.controlBox.btnName&&(i=this.toolBox.x,a=this.toolBox.y,this.toolBox.width=this.controlBox.start.width+e,this.toolBox.height=this.controlBox.start.height+o),"leftDown"==this.controlBox.btnName&&(i=this.toolBox.x+e,a=this.toolBox.y,this.toolBox.width=this.controlBox.start.width-e,this.toolBox.height=this.controlBox.start.height+o),"topCenter"==this.controlBox.btnName&&(i=this.toolBox.x,a=this.toolBox.y+o,this.toolBox.width=this.controlBox.start.width,this.toolBox.height=this.controlBox.start.height-o),"downCenter"==this.controlBox.btnName&&(i=this.toolBox.x,a=this.toolBox.y,this.toolBox.width=this.controlBox.start.width,this.toolBox.height=this.controlBox.start.height+o),"leftCenter"==this.controlBox.btnName&&(i=this.toolBox.x+e,a=this.toolBox.y,this.toolBox.width=this.controlBox.start.width-e,this.toolBox.height=this.controlBox.start.height),"rightCenter"==this.controlBox.btnName&&(i=this.toolBox.x,a=this.toolBox.y,this.toolBox.width=this.controlBox.start.width+e,this.toolBox.height=this.controlBox.start.height),this.drawControlBox(this.toolBox.width,this.toolBox.height,i,a)}t.stopPropagation()},cropPicture:function(t){var e=this;if(this.drawImg.img){var o=this.$refs.canvas;if(this.WatermarkText&&!t){var i=o.getContext("2d");i.font=this.WatermarkTextFont,i.fillStyle=this.WatermarkTextColor,i.textAlign="right",i.textBaseline="bottom",i.fillText(this.WatermarkText,this.toolBox.x+this.toolBox.width*this.WatermarkTextX,this.toolBox.y+this.toolBox.height*this.WatermarkTextY)}var a=new Image;!0===this.crossOrigin&&(a.crossOrigin=this.crossOriginHeader),a.src=o.toDataURL(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,i){window.atob?setTimeout(function(){for(var a=atob(o.toDataURL(e,i).split(",")[1]),n=a.length,s=new Uint8Array(n),l=0;l<n;l++)s[l]=a.charCodeAt(l);t(new Blob([s],{type:e||"image/png"}))},200):t(!1,{type:"image/png"})}}),o.toBlob(function(o){if(o){var i=new FileReader;i.readAsDataURL(o),i.onload=function(){var o=setInterval(function(){if(2==i.readyState){clearInterval(o);var n=document.createElement("canvas"),s=n.getContext("2d");if(1==e.originalGraph){var l=e.drawImg.width/e.drawImg.swidth,r=e.toolBox.width/l,c=e.toolBox.height/l;n.width=r,n.height=c;var h=(e.toolBox.x-e.drawImg.x)/l,d=(e.toolBox.y-e.drawImg.y)/l,u=e.drawImg.swidth,g=e.drawImg.sheight;s.translate(-h,-d),s.drawImage(e.drawImg.img,0,0,u,g)}else{n.width=e.toolBox.width,n.height=e.toolBox.height;var m=e.toolBox;if(e.rate){var p=e.rate.split(":")[0]/e.rate.split(":")[1];e.rate.split(":")[0]>=e.rate.split(":")[1]?s.drawImage(a,m.x,m.y,m.width,m.width*p,0,0,m.width,m.width*p):s.drawImage(a,m.x,m.y,m.width,m.width/p,0,0,m.width,m.width/p)}else s.drawImage(a,m.x,m.y,m.width,m.height,0,0,m.width,m.height)}n.toBlob(function(o){t?e.$emit("onPrintImg",{fileName:e.fileName,blob:o,file:e.dataURLtoFile(n.toDataURL(),e.fileName),dataURL:n.toDataURL()}):(e.handleClose(),e.$emit("cutDown",{fileName:e.fileName,blob:o,file:e.dataURLtoFile(n.toDataURL(),e.fileName),dataURL:n.toDataURL()}))},"image/jpeg",.95)}},200)}}else{var n=document.createElement("canvas");n.width=e.toolBox.width,n.height=e.toolBox.height;var s=n.getContext("2d"),l=e.toolBox;if(e.rate){var r=e.rate.split(":")[0]/e.rate.split(":")[1];s.drawImage(a,l.x,l.y,l.width,l.width*r,0,0,l.width,l.width*r)}else s.drawImage(a,l.x,l.y,l.width,l.height,0,0,l.width,l.height);t?e.$emit("onPrintImg",{fileName:e.fileName,dataURL:n.toDataURL()}):(e.handleClose(),e.$emit("cutDown",{fileName:e.fileName,dataURL:n.toDataURL()}))}})}else t||(console.warn("No picture selected"),e.$emit("error",{err:1,msg:"No picture selected"}))},scrollBarControlMove:function(t){if(this.rotateControl.active){var e=t.pageX-this.rotateControl.start.x,o=this.rotateControl.start.position+e;o<=0&&(o=0),o>=200&&(o=200),this.rotateControl.position=o,this.rotateImg.angle=(o-100)/100*180,this.printImg()}},scrollBarControlOn:function(t){this.rotateControl.active=!0,this.rotateControl.start.x=t.pageX,this.rotateControl.start.y=t.pageY,this.rotateControl.start.position=this.rotateControl.position},scrollBarControlOff:function(){this.rotateControl.active=!1}}},B={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[!0===t.showChooseBtn&&!0===t.isModal?o("div",{on:{click:t.handleOpen}},[t._t("openImgCutter"),t._v(" "),t._t("open")],2):t._e(),t._v(" "),t.$slots.openImgCutter||t.$slots.open||!0!==t.isModal?t._e():o("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.handleOpen}},[t._v(t._s(t.label))]),t._v(" "),o("transition",{attrs:{name:"fade"}},[t.visible?o("div",{ref:"mask",class:!0===t.isModal?"mask vue-img-cutter":""},[t.visible?o("div",{class:!0===t.isModal?"dialogBoxModal":"dialogBox"},[o("transition",{attrs:{name:"fade","enter-class":"fade-in-enter","enter-active-class":"fade-in-active","leave-class":"fade-out-enter","leave-active-class":"fade-out-active"}},[o("div",{ref:"dialogMainModalRef",class:!0===t.isModal?"dialogMainModal":"dialogMain",style:"width:"+(!0===t.isModal?t.boxWidth+32:t.boxWidth)+"px"},[o("div",{staticClass:"toolMain"},[!0===t.isModal?o("div",{staticClass:"tool-title"},[t._v("\n                图片裁剪\n                "),o("span",{staticClass:"closeIcon",on:{click:t.handleClose}},[t._v("×")])]):t._e(),t._v(" "),o("div",{ref:"toolBox",staticClass:"toolBox",style:"height:"+t.boxHeight+"px;width:"+t.boxWidth+"px",on:{mousemove:t.controlBtnMouseMove,mouseup:t.controlBtnMouseUp,mouseleave:t.controlBtnMouseUp}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.drawImg.img&&!0===t.showChooseBtn,expression:"!drawImg.img && showChooseBtn===true"}],staticClass:"tips"},[o("div",{staticClass:"btn btn-warning btn-xs",on:{click:t.chooseImg}},[t._v(t._s(t.label))])]),t._v(" "),1==t.tool?o("div",{directives:[{name:"show",rawName:"v-show",value:this.drawImg.img&&!0!==t.dropImg.active&&1==t.controlBox.disable&&1==t.toolBox.disable,expression:"this.drawImg.img && dropImg.active!==true && controlBox.disable==true && toolBox.disable==true"}],staticClass:"dockMain",style:"background:"+this.toolBgc,on:{mouseenter:t.dropImgOff}},[t.rate?o("div",{staticClass:"dockBtn"},[t._t("ratio",[t._v("\n                      Ratio:\n                    ")]),t._v("\n                    "+t._s(t.rate)+"\n                  ")],2):t._e(),t._v(" "),o("div",{staticClass:"dockBtn",on:{click:t.scaleReset}},[t._t("scaleReset",[t._v("\n                      Scale:\n                    ")]),t._v("\n                    "+t._s(t.drawImg.swidth>0?(t.drawImg.width/t.drawImg.swidth).toFixed(2):"-")+"\n                  ")],2),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtn",on:{click:function(e){return t.turnImg(-90)}}},[t._t("turnLeft",[t._v("\n                      ↳\n                    ")])],2):t._e(),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtn",on:{click:function(e){return t.turnImg(90)}}},[t._t("turnRight",[t._v("\n                      ↲\n                    ")])],2):t._e(),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtn",on:{click:function(e){return t.turnReset()}}},[t._t("reset",[t._v("\n                      ↻\n                    ")])],2):t._e(),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtnScrollBar"},[o("div",{ref:"dockBtnScrollControl",staticClass:"scrollBarControl",style:"left:"+t.rotateControl.position+"px",on:{mousemove:t.scrollBarControlMove,mousedown:t.scrollBarControlOn,mouseleave:t.scrollBarControlOff,mouseup:t.scrollBarControlOff}}),t._v(" "),1==t.rotateControl.active?o("div",{staticClass:"scrollBarText",style:"left:"+t.rotateControl.position+"px"},[t._v("\n                      "+t._s(t.rotateImg.angle.toFixed(0)+"°")+"\n                    ")]):t._e()]):t._e(),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtn",on:{click:t.flipHorizontal}},[t._t("flipHorizontal",[t._v("\n                      ⇆\n                    ")])],2):t._e(),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"dockBtn",on:{click:t.flipVertically}},[t._t("turnRight",[t._v("\n                      ⇅\n                    ")])],2):t._e()]):t._e(),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:null!=t.drawImg.img,expression:"drawImg.img!=null"}],ref:"toolBoxControl",staticClass:"toolBoxControl",on:{mousedown:t.toolBoxMouseDown,mouseup:t.toolBoxMouseUp,mousemove:t.toolBoxMouseMove,mouseleave:t.toolBoxMouseLeave}},[o("div",{staticClass:"toolBoxControlBox"},[o("div",{staticClass:"controlBox"},[o("div",{staticClass:"controlBoxInnerLine controlBoxInnerLineTop"}),t._v(" "),o("div",{staticClass:"controlBoxInnerLine controlBoxInnerLineBottom"}),t._v(" "),o("div",{staticClass:"controlBoxInnerLine controlBoxInnerLineLeft"}),t._v(" "),o("div",{staticClass:"controlBoxInnerLine controlBoxInnerLineRight"}),t._v(" "),!1===t.originalGraph?o("div",{staticClass:"selectArea"},[t._v("\n                        宽:"+t._s(t.toolBox.width)+" 高:"+t._s(t.toolBox.height)+"\n                        (x:"+t._s(t.toolBoxPosition.x)+",y:"+t._s(t.toolBoxPosition.y)+")\n                      ")]):t._e(),t._v(" "),!0===t.originalGraph?o("div",{staticClass:"selectArea"},[t._v("\n                        宽:"+t._s((t.toolBox.width/(t.drawImg.width/t.drawImg.swidth)).toFixed(0))+" 高:"+t._s((t.toolBox.height/(t.drawImg.width/t.drawImg.swidth)).toFixed(0))+"\n                        (x:"+t._s(t.toolBoxPosition.x)+",y:"+t._s(t.toolBoxPosition.y)+")\n                      ")]):t._e(),t._v(" "),!0===t.sizeChange?o("div",{staticClass:"leftUp controlBtn",attrs:{"data-name":"leftUp"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"leftUp")}}}):t._e(),t._v(" "),!0===t.sizeChange?o("div",{staticClass:"leftDown controlBtn",attrs:{"data-name":"leftDown"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"leftDown")}}}):t._e(),t._v(" "),!0===t.sizeChange?o("div",{staticClass:"rightUp controlBtn",attrs:{"data-name":"rightUp"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"rightUp")}}}):t._e(),t._v(" "),!0===t.sizeChange?o("div",{staticClass:"rightDown controlBtn",attrs:{"data-name":"rightDown"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"rightDown")}}}):t._e(),t._v(" "),!0===t.sizeChange&&!t.rate&&this.toolBox.width>20?o("div",{staticClass:"topCenter controlBtn",attrs:{"data-name":"topCenter"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"topCenter")}}}):t._e(),t._v(" "),!0===t.sizeChange&&!t.rate&&this.toolBox.width>20?o("div",{staticClass:"downCenter controlBtn",attrs:{"data-name":"downCenter"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"downCenter")}}}):t._e(),t._v(" "),!0===t.sizeChange&&!t.rate&&this.toolBox.height>20?o("div",{staticClass:"leftCenter controlBtn",attrs:{"data-name":"leftCenter"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"leftCenter")}}}):t._e(),t._v(" "),!0===t.sizeChange&&!t.rate&&this.toolBox.height>20?o("div",{staticClass:"rightCenter controlBtn",attrs:{"data-name":"rightCenter"},on:{mousedown:function(e){return t.controlBtnMouseDown(e,"rightCenter")}}}):t._e()]),t._v(" "),o("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-1"}),t._v(" "),o("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-2"}),t._v(" "),o("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-3"}),t._v(" "),o("div",{staticClass:"toolBoxControlLine toolBoxControlLineItem-4"})])]),t._v(" "),o("div",{staticClass:"copyright"},[t.DoNotDisplayCopyright?t._e():o("a",{attrs:{target:"_blank",href:"https://github.com/acccccccb/vue-img-cutter",rel:"nofollow"}},[t._v("vue-img-cutter "+t._s(t.version))])]),t._v(" "),o("canvas",{ref:"canvasSelectBox",staticClass:"canvasSelectBox",attrs:{width:t.boxWidth,height:t.boxHeight},on:{mousedown:t.dropImgOn,mouseup:t.dropImgOff,mousemove:t.dropImgMove}}),t._v(" "),o("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.boxWidth,height:t.boxHeight}})])]),t._v(" "),o("div",{staticClass:"i-dialog-footer"},[o("input",{ref:"inputFile",staticStyle:{width:"1px",height:"1px",border:"none",opacity:"0"},attrs:{type:"file",accept:"image/gif, image/jpeg ,image/png"},on:{change:t.putImgToCanv}}),t._v(" "),o("span",{on:{click:t.chooseImg}},[t._t("choose",[!0===t.showChooseBtn?o("div",{staticClass:"btn btn-primary btn-primary-plain"},[t._v(t._s(t.label))]):t._e()])],2),t._v(" "),o("div",{staticClass:"btn-group fr"},[o("span",{on:{click:t.handleClose}},[t._t("cancel",[o("button",{staticClass:"btn btn-default",attrs:{type:"button"}},[t._v("取消")])])],2),t._v(" "),o("span",{on:{click:function(e){return t.cropPicture(!1)}}},[t._t("confirm",[o("button",{staticClass:"btn btn-primary",staticStyle:{"margin-left":"15px"},attrs:{type:"button",disabled:!t.drawImg.img}},[t._v("确定")])])],2)])])])]),t._v(" "),o("div",{staticStyle:{clear:"both"}})],1):t._e()]):t._e()])],1)},staticRenderFns:[]};var _=o("VU/8")(y,B,!1,function(t){o("o4pE")},"data-v-391fd2ed",null).exports,I=o("//Fk"),C=o.n(I),k=o("T452"),M=o("xjP8"),T=o("vLgD"),S={headers:{"Content-Type":"multipart/form-data"}};function D(t){return new C.a(function(e,o){T.a.post(M.a+k.f,t,S).then(function(t){console.log(t),e(t)}).catch(function(t){o(t),console.log(t)})})}function O(t){var e=t.indexOf("T"),o=t.indexOf("Z"),i=t.substr(0,e)+" "+t.substr(e+1,o-e-1);a=(a=new Date(Date.parse(i))).getTime();var a=(a/=1e3)+28800;return new Date(1e3*parseInt(a)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")}let L;const $=(t,e)=>{"ie"==(()=>{let t=window.navigator.userAgent;return t.indexOf("MSIE")>=0?"ie":t.indexOf("Firefox")>=0?"Firefox":t.indexOf("Chrome")>=0?"Chrome":t.indexOf("Opera")>=0?"Opera":t.indexOf("Safari")>=0?"Safari":void 0})()?F(t,e):E(t,e)},F=(t,e)=>{let o=t,i=new ActiveXObject("Excel.Application"),a=i.Workbooks.Add(),n=a.Worksheets(1),s=document.body.createTextRange();s.moveToElementText(o),s.select,s.execCommand("Copy"),n.Paste(),i.Visible=!0;try{let t=i.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(t){print("Nested catch caught "+t)}finally{a.SaveAs(t),a.Close(savechanges=!1),i.Quit(),i=null,window.setInterval("Cleanup();",1),L=window.setInterval("Cleanup();",1)}},E=(t,e)=>{const o="data:application/vnd.ms-excel;base64,"+(U=((t,e)=>t.replace(/{(\w+)}/g,(t,o)=>e[o]))('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',{worksheet:e,table:t}),window.btoa(unescape(encodeURIComponent(U))));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=o;else{const t=document.createElement("a");let i;t.href=o,t.download=e||"",window.MouseEvent?i=new MouseEvent("click"):(i=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(i)}};var U;var N=(t,e,o)=>{const i={image:function(t,e){return`<td style="width: ${(e=Object.assign({width:40,height:60},e)).width}px; height: ${e.height}px; text-align: center; vertical-align: middle"><img src="${t}" width=${e.width} height=${e.height}></td>`},text:function(t){return`<td style="text-align: center">${t}</td>`}};let a=t.reduce((t,e)=>t+=`<th>${e.title}</th>`,"");a=`<thead><tr>${a}</tr></thead>`;let n=e.reduce((e,o)=>e+=`<tr>${t.reduce((t,e)=>t+=i[e.type||"text"](o[e.key],e),"")}</tr>`,"");$(a+(n=`<tbody>${n}</tbody>`),o)},z=o("NYxO"),R=o("gRE1"),P=o.n(R),A=o("fZjL"),W=o.n(A),j=o("7+uW");const H=j.default.prototype.$isServer,V=(H||Number(document.documentMode),!H&&document.addEventListener?function(t,e,o){t&&e&&o&&t.addEventListener(e,o,!1)}:function(t,e,o){t&&e&&o&&t.attachEvent("on"+e,o)}),q=!H&&document.removeEventListener?function(t,e,o){t&&e&&t.removeEventListener(e,o,!1)}:function(t,e,o){t&&e&&t.detachEvent("on"+e,o)};Object.prototype.hasOwnProperty;function Y(t){let e=!1;return function(...o){e||(e=!0,window.requestAnimationFrame(i=>{t.apply(this,o),e=!1}))}}var X={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},G=!j.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",J={name:"elImageViewer",props:{urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:X.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.urlList[this.index]},imgStyle:function(){var t=this.transform,e=t.scale,o=t.deg,i=t.offsetX,a=t.offsetY,n={transform:"scale("+e+") rotate("+o+"deg)",transition:t.enableTransition?"transform .3s":"","margin-left":i+"px","margin-top":a+"px"};return this.mode===X.CONTAIN&&(n.maxWidth=n.maxHeight="100%"),n}},watch:{index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg:function(t){var e=this;this.$nextTick(function(t){e.$refs.img[0].complete||(e.loading=!0)})}},methods:{hide:function(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var t=this;this._keyDownHandler=Y(function(e){switch(e.keyCode){case 27:t.hide();break;case 32:t.toggleMode();break;case 37:t.prev();break;case 38:t.handleActions("zoomIn");break;case 39:t.next();break;case 40:t.handleActions("zoomOut")}}),this._mouseWheelHandler=Y(function(e){(e.wheelDelta?e.wheelDelta:-e.detail)>0?t.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):t.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})}),V(document,"keydown",this._keyDownHandler),V(document,G,this._mouseWheelHandler)},deviceSupportUninstall:function(){q(document,"keydown",this._keyDownHandler),q(document,G,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(t){this.loading=!1},handleImgError:function(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown:function(t){var e=this;if(!this.loading&&0===t.button){var o=this.transform,i=o.offsetX,a=o.offsetY,n=t.pageX,s=t.pageY;this._dragHandler=Y(function(t){e.transform.offsetX=i+t.pageX-n,e.transform.offsetY=a+t.pageY-s}),V(document,"mousemove",this._dragHandler),V(document,"mouseup",function(t){q(document,"mousemove",e._dragHandler)}),t.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var t=W()(X),e=(P()(X).indexOf(this.mode)+1)%t.length;this.mode=X[t[e]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var t=this.urlList.length;this.index=(this.index-1+t)%t}},next:function(){if(!this.isLast||this.infinite){var t=this.urlList.length;this.index=(this.index+1)%t}},handleActions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var o=a()({zoomRate:.2,rotateDeg:90,enableTransition:!0},e),i=o.zoomRate,n=o.rotateDeg,s=o.enableTransition,l=this.transform;switch(t){case"zoomOut":l.scale>.2&&(l.scale=parseFloat((l.scale-i).toFixed(3)));break;case"zoomIn":l.scale=parseFloat((l.scale+i).toFixed(3));break;case"clocelise":l.deg+=n;break;case"anticlocelise":l.deg-=n}l.enableTransition=s}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},Q={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"viewer-fade"}},[o("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":t.zIndex},attrs:{tabindex:"-1"}},[o("div",{staticClass:"el-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleMaskClick(e)}}}),t._v(" "),o("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:t.hide}},[o("i",{staticClass:"el-icon-close"})]),t._v(" "),t.isSingle?t._e():[o("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!t.infinite&&t.isFirst},on:{click:t.prev}},[o("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),o("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!t.infinite&&t.isLast},on:{click:t.next}},[o("i",{staticClass:"el-icon-arrow-right"})])],t._v(" "),o("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[o("div",{staticClass:"el-image-viewer__actions__inner"},[o("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return t.handleActions("zoomOut")}}}),t._v(" "),o("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return t.handleActions("zoomIn")}}}),t._v(" "),o("i",{staticClass:"el-image-viewer__actions__divider"}),t._v(" "),o("i",{class:t.mode.icon,on:{click:t.toggleMode}}),t._v(" "),o("i",{staticClass:"el-image-viewer__actions__divider"}),t._v(" "),o("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return t.handleActions("anticlocelise")}}}),t._v(" "),o("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return t.handleActions("clocelise")}}})])]),t._v(" "),o("div",{staticClass:"el-image-viewer__canvas"},t._l(t.urlList,function(e,i){return i===t.index?o("img",{key:e,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:t.imgStyle,attrs:{src:t.currentImg},on:{load:t.handleImgLoad,error:t.handleImgError,mousedown:t.handleMouseDown}}):t._e()}),0)],2)])},staticRenderFns:[]},Z=o("VU/8")(J,Q,!1,null,null,null).exports,K={data:function(){var t;return t={showViewer:!1,url:"",imgUrl1:"",imgUrl2:"",dialogVisible:!1,level:0,options:[{value:"主板",label:"主板"},{value:"小卡",label:"小卡"}],options1:[{value:"正常",label:"正常"},{value:"不正常",label:"不正常"}],options2:[{value:"shundai",label:"shundai"},{value:"leedu",label:"leedu"},{value:"無賬",label:"無賬"}],options3:[{value:"shundai",label:"shundai"},{value:"leedu",label:"leedu"}],options4:[{value:"1 : 1",label:"1 : 1"},{value:"2 : 1",label:"2 : 1"},{value:"3 : 1",label:"3 : 1"}],needle:{boardModel:"",boardType:"主板",status:"正常",num:1,imgUrl:"",description:"",owner:"shundai",uploader:"leedu",rate:"1 : 1"},valueDate:[],value:""},h()(t,"dialogVisible",!1),h()(t,"pictLoading",!1),h()(t,"tableData",[]),h()(t,"currentPage",1),h()(t,"pageSize",10),h()(t,"userNum",""),h()(t,"startDate",""),h()(t,"total",0),t},methods:{closeViewer:function(){this.showViewer=!1},showImg:function(t){this.url=t,this.showViewer=!0},updateBoardInfo:function(t){this.level=1,this.needle=t,this.imgUrl1=t.imgUrl,this.dialogVisible=!0},handleClick:function(t){var e,o=this,i=t._id;(e={_id:i,username:this.userInfo.username},new C.a(function(t,o){T.a.post(M.a+k.b,e).then(function(e){console.log(e),t(e)}).catch(function(t){o(t),console.log(t)})})).then(function(t){"error"===t.data?o.$message({message:"删除失败!",type:"warning"}):"ok"===t.data?(o.$message({message:"删除成功!",type:"success"}),o._search()):o.$message({message:"未知错误请联系管理员!",type:"error"})})},uploadIssueInfo:function(){var t,e=this;this.isLogin?0===this.level?(t=r()({},this.needle,{username:this.userInfo.username}),new C.a(function(e,o){T.a.post(M.a+k.a,t).then(function(t){console.log(t),e(t)}).catch(function(t){o(t),console.log(t)})})).then(function(t){t.data?"no_exist"===t.data?e.$message({message:"用户名不存在！",type:"warning"}):"isExist"===t.data?e.$message({message:"上傳主板已存在！",type:"warning"}):(e.$message({message:"上傳成功!",type:"success"}),e.dialogVisible=!1,e._search()):(e.$message({message:"token过期，请重新登录",type:"warning"}),e.dialogVisible=!1)}).catch(function(t){console.log(res)}):1===this.level&&function(t){return new C.a(function(e,o){T.a.post(M.a+k.e,t).then(function(t){console.log(t),e(t)}).catch(function(t){o(t),console.log(t)})})}(this.needle).then(function(t){e.dialogVisible=!1,e.$message({message:"更新成功!",type:"success"}),e._search()}):this.$message({message:"请登录",type:"warning"})},resultImage:function(t){var e=new FormData;e.append("image",t.blob);var o=this;D(e).then(function(t){o.issue.imgUrlRes=t.data.url}),this.imgUrl2=t.dataURL},cutDown:function(t){var e=new FormData;e.append("image",t.blob);var o=this;D(e).then(function(t){o.needle.imgUrl=t.data.url}),this.imgUrl1=t.dataURL},_addItem:function(){this.level=0,this.needle={boardModel:"",boardType:"主板",status:"正常",num:1,imgUrl:"",description:"",owner:"shundai",uploader:"leedu",rate:"1 : 1"},this.dialogVisible=!0},_search:function(){var t,e,o,i=this;this.pictLoading=!0,(t=this.pageSize,e=this.currentPage,o=s()(this.valueDate),new C.a(function(i,a){T.a.get(M.a+k.d+"?limit="+t+"&skip="+(e-1)*t+"&dateArray="+o).then(function(t){i(t)}).catch(function(t){a(t),console.log(t)})})).then(function(t){t.data.data.forEach(function(t){t.createDate=O(t.createDate)}),i.tableData=t.data.data,i.total=t.data.total,i.pictLoading=!1})},_exportExcel:function(){var t,e=this;(t=s()(this.valueDate),new C.a(function(e,o){T.a.get(M.a+k.c+"?dateArray="+t).then(function(t){e(t)}).catch(function(t){o(t),console.log(t)})})).then(function(t){t.data.data.forEach(function(t){t.imgUrl=t.imgUrl+t.rate.substring(0,1),t.createDate=O(t.createTime)});var o=e.valueDate.length>1?"FAE寶安區主板&小卡資料統計表 "+e.valueDate[0].substring(0,10)+"-"+e.valueDate[1].substring(0,10)+".xls":"FAE寶安區主板&小卡資料統計表.xls";e.tableData.length?N([{title:"幾種",key:"boardModel",type:"text"},{title:"主板圖",key:"imgUrl",type:"image"},{title:"類型",key:"boardType",type:"text"},{title:"總數量",key:"num",type:"text"},{title:"狀態",key:"status",type:"text"},{title:"說明",key:"description",type:"text"},{title:"掛賬人",key:"owner",type:"text"},{title:"上傳人員",key:"uploader",type:"text"},{title:"上傳時間",key:"createTime",type:"text"}],t.data.data,o):e.$message({message:"Please select at least one item",type:"warning"})})},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this._search()},handleCurrentChange:function(t){this.currentPage=t,this._search()}},mounted:function(){this._search()},computed:a()({},Object(z.d)({isLogin:function(t){return t.isLogin}}),Object(z.b)(["userInfo"])),components:{BasePagination:g,DataTable:v,ImgCutter:_,ElImageViewer:Z}},tt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showViewer?o("el-image-viewer",{attrs:{"on-close":t.closeViewer,"url-list":[t.url]}}):t._e(),t._v(" "),o("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"10px"}},[o("div",{staticStyle:{display:"flex"}},[o("span",{staticClass:"title",staticStyle:{"margin-left":"20px"}},[t._v("日期 :")]),t._v(" "),o("el-date-picker",{attrs:{type:"daterange","range-separator":"至",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd 00:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.valueDate,callback:function(e){t.valueDate=e},expression:"valueDate"}})],1),t._v(" "),o("div",[o("el-button",{staticClass:"exportExcel",staticStyle:{"margin-right":"20px","text-align":"right",background:"#77A1D3"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:t._exportExcel}},[t._v("導出Excel")]),t._v(" "),o("el-button",{staticClass:"exportExcel",staticStyle:{"margin-right":"20px","text-align":"right",background:"#20BDFF"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t._addItem}},[t._v("新增数据")]),t._v(" "),o("el-button",{staticStyle:{background:"#3CA55C"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t._search}},[t._v("搜索")])],1)]),t._v(" "),t.tableData.length?o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-text":"数据正在加载中","element-loading-spinner":"el-icon-loading",stripe:!0,border:!0,data:t.tableData,"highlight-current-row":""}},[o("el-table-column",{attrs:{type:"index",label:"序號",width:"55"}}),t._v(" "),o("el-table-column",{attrs:{property:"boardModel",label:"幾種"}}),t._v(" "),o("el-table-column",{attrs:{property:"boardType",label:"類型"}}),t._v(" "),o("el-table-column",{attrs:{property:"num",label:"總數量"}}),t._v(" "),o("el-table-column",{attrs:{property:"status",label:"狀態"}}),t._v(" "),o("el-table-column",{staticStyle:{cursor:"pointer"},attrs:{property:"imgUrl",label:"主板圖片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.imgUrl?o("img",{attrs:{src:e.row.imgUrl,width:"100"},on:{click:function(o){return t.showImg(e.row.imgUrl)}}}):t._e()]}}],null,!1,191358525)}),t._v(" "),o("el-table-column",{attrs:{property:"description",label:"說明"}}),t._v(" "),o("el-table-column",{attrs:{property:"owner",label:"掛賬人"}}),t._v(" "),o("el-table-column",{attrs:{property:"uploader",label:"上傳人員"}}),t._v(" "),o("el-table-column",{attrs:{property:"createDate",label:"創建時間"}}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.userInfo.username?o("el-button",{attrs:{slot:"reference",type:"text",size:"small"},on:{click:function(o){return t.updateBoardInfo(e.row)}},slot:"reference"},[t._v("修改")]):t._e(),t._v(" "),o("el-popconfirm",{attrs:{title:"这是一段内容确定删除吗？"},on:{confirm:function(o){return t.handleClick(e.row)}}},[t.userInfo.username?o("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[t._v("删除")]):t._e()],1)]}}],null,!1,3225837325)})],1):t._e(),t._v(" "),t.tableData.length?o("BasePagination",{attrs:{total:t.total},on:{handleCurrentChange:t.handleCurrentChange,handleSizeChange:t.handleSizeChange}}):t._e(),t._v(" "),o("el-dialog",{attrs:{title:"EPS主板資料上傳","close-on-click-modal":!1,visible:t.dialogVisible,width:"1200px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[o("div",[o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("幾種 :")]),o("el-input",{staticStyle:{width:"220px"},model:{value:t.needle.boardModel,callback:function(e){t.$set(t.needle,"boardModel",e)},expression:"needle.boardModel"}})],1),t._v(" "),o("div",{staticStyle:{"margin-top":"10px",display:"flex"}},[o("span",{staticClass:"title"},[t._v("類型 :")]),o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.needle.boardType,callback:function(e){t.$set(t.needle,"boardType",e)},expression:"needle.boardType"}},t._l(t.options,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("狀態 :")]),o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.needle.status,callback:function(e){t.$set(t.needle,"status",e)},expression:"needle.status"}},t._l(t.options1,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("數量 :")]),o("el-input",{staticStyle:{width:"220px"},attrs:{type:"number"},model:{value:t.needle.num,callback:function(e){t.$set(t.needle,"num",e)},expression:"needle.num"}})],1),t._v(" "),o("div",{staticStyle:{display:"flex","margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("掛賬人 :")]),o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.needle.owner,callback:function(e){t.$set(t.needle,"owner",e)},expression:"needle.owner"}},t._l(t.options2,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("div",{staticStyle:{display:"flex","margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("說明 :")]),o("el-input",{staticStyle:{width:"220px"},model:{value:t.needle.description,callback:function(e){t.$set(t.needle,"description",e)},expression:"needle.description"}})],1),t._v(" "),o("div",{staticStyle:{display:"flex","margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("上傳人員 :")]),o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.needle.uploader,callback:function(e){t.$set(t.needle,"uploader",e)},expression:"needle.uploader"}},t._l(t.options3,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]),t._v(" "),o("div",[o("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[o("ImgCutter",{attrs:{rate:t.needle.rate,label:"照片"},on:{cutDown:t.cutDown}}),t._v(" "),o("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t.imgUrl1,width:"400px",alt:"照片"}})],1),t._v(" "),o("div",{staticStyle:{display:"flex","margin-top":"10px"}},[o("span",{staticClass:"title"},[t._v("裁剪比例选择 :")]),o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.needle.rate,callback:function(e){t.$set(t.needle,"rate",e)},expression:"needle.rate"}},t._l(t.options4,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)])]),t._v(" "),o("div"),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.uploadIssueInfo}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var et=o("VU/8")(K,tt,!1,function(t){o("iLP3")},"data-v-001f0690",null);e.default=et.exports}});
//# sourceMappingURL=0.1a119b72f430199c2ac9.js.map